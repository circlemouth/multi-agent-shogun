Usage:
  tmux-send-2step.sh msg   [options] <target> <message...>
  tmux-send-2step.sh enter [options] <target> [options]

Target:
  - A fully qualified pane target: <session>:<window>.<pane>  (example: multiagent:0.0)
  - A pane id: %<number>
  - An agent id (resolved via pane option @agent_id): karo | shogun | ashigaruN
  - An agent id prefixed with "@": @karo | @ashigaru8

Examples:
  # MUST be two separate bash invocations:
  tmux-send-2step.sh msg multiagent:0.0 'report ready'
  tmux-send-2step.sh enter multiagent:0.0 --check --tail 30
  # Resolve by @agent_id (recommended for robustness):
  tmux-send-2step.sh msg @karo 'report ready'
  tmux-send-2step.sh enter @karo

Notes:
  - Always send message first, then Enter (in a separate bash call).
  - This script is intentionally 2-step. Do NOT try to merge msg + Enter into one call.
  - Use single quotes around <message> to preserve spaces.
  - Message must not include newline characters (\\n / \\r).

Options:
  --check               After sending, capture the target pane tail (debug/evidence).
  --tail N              Tail lines for --check (default: 20).
  --retry N             (enter mode) resend Enter up to N additional times (default: 2).
  --lock-timeout-ms N   Wait up to N ms to acquire per-target lock (default: 1500).
  --stale-sec N         Pending msg state TTL in seconds (default: 30).
  --force               (msg mode) allow overriding a non-stale pending state.
